\chapter{Introduction}

\section{Review of ZDC electronics and cabling}
\subsection{ZDC Photomultipiers}
Currently, installed photomultiplier assembly (photomultiplier tube, voltage-divider circuit and other components, all integrated into a single case) is Hamamatsu H2431-50, having by default photomultiplier tube (PMT) Hamamatsu R2083 \cite{PMTtube} (that differs from the one in the ZDC design report \cite{ZDCdocumentation}).

\subsection{High-voltage power supply}
Photomultiplier tubes (PMT) at ZDC are connected to high voltage crate LeCroy 1440, situated in the close proximity of the STAR detector, in the same place as supplies of other detectors, on the STAR
infrastructer platform. There are two power supplies (Fig.\ref{hvsupplies}). Currently, one of them seems to be unable to output voltage high enough. Generally, these power supplies have maximum output of 5 kV, but on the cables connected to PMTs, there is a component, that limits maximum output to 3 kV. This is probably for the protection of PMTs.

\begin{figure}[htb]
\begin{center}
\includegraphics[width=.7\textwidth]{img/hvsupplies.jpg}
\end{center}
\caption{Power supplies, that are used for ZDC PMTs.}
\label{hvsupplies}
\end{figure}

High voltage cables are not directly connected to the PMTs, they are connected thrrough patch panels PP1 for the west and PP2 for the east (see Fig.~\ref{pp1} and Fig.~\ref{pp2}). Both of the patch pannels are located on the sides of the STAR infrastructer platform. Output from PMTs is connected to the logic units via PP1 and PP2 as well.

\begin{figure}[htb]
\begin{center}
\includegraphics[width=.7\textwidth]{img/pp1.jpg}
\end{center}
\caption{Patch panel 1 for ZDC west.  ZDC cables are on the left, high voltage are red and output from PMTS are black.}
\label{pp1}
\end{figure}

\begin{figure}[htb]
\begin{center}
\includegraphics[width=.7\textwidth]{img/pp2.jpg}
\end{center}
\caption{Patch panel 2 for ZDC east high voltage (red cables) and output from PMTS (black cables).}
\label{pp2}
\end{figure}

Power supplies are accessed via an RS232 port that is connected to the, so called, BDB computer. On this computer, there are IOC (input/output controlers) for several detectors. The one for ZDC can be accessed from the \texttt{sc5.starp.bnl.gov} computer (SC5).

\subsection{Signal output}

Each PMT has its own signal output. All of them go through PP1 or PP2 to their counterparts, that are close to TCIM unit (Fig.~\ref{tcimpp}). Then, they are connected to logic unit in the, so called, NIM crate (Fig.~\ref{lu_sum}). Two of the outputs from this unit are sum signals, one for ZDC east and the other for ZDC west. Another output is "ZDC and" signal, which is the coincidence signal of the east and the west sums. All of these, together with signal from every PMT, are connected to TCIM.

\begin{figure}[htb]
\begin{center}
\includegraphics[width=.7\textwidth]{img/tcimpp.jpg}
\end{center}
\caption{TCIM and patch panel for the ZDC east.}
\label{tcimpp}
\end{figure}


\begin{figure}[htb]
\begin{center}
\includegraphics[width=.7\textwidth]{img/lusum.jpg}
\end{center}
\caption{Logic unit for ZDC signal processing.}
\label{lu_sum}
\end{figure}

The TCIM is another logic unit.  It can be accessed from any  computer within the STAR network
from a browser on the website\\ 
\url{172.16.15.101/AnalogandCoincidenceLogic13.html}.\\
The power switch of the TCIM is at \texttt{tof@tofrnps} (tofrpns = TOF remote network power switch).
Using TCIM, ZDC signal can be controlled. Here, the ``ZDC kill'' signal is connected as well. This is a TTL signal that nullifies (kills) everything going from the ZDC in preset time intervals. The
kill signal frequency can be changed from the TCIM website.

TTL output from TCIM is connected to another logic unit, situated in DAQ room at STAR. Rescalers, calculated with this unit, can be accessed from SC5 computer.

TDC (timing of the ZDC events) can be set at \texttt{startrg.starp.bnl.gov}. At this computer, status and control of TCIM can be accessed via a browser.

\section{List of important computers and commands that control the ZDC electronics}

To gain access all of the important detector control hosts, one needs to add request at \url{https://www.star.bnl.gov/starkeyw/}. All of the hosts listed below, can be accessed from RCF using RSA public key of your computer, if it is not described otherwise.
\begin{outline}
 \1 \texttt{stargw.starp.bnl.gov}, account name: STAR user name
   \2 STAR Gateways
 \1 \texttt{sysuser@sc5.starp.bnl.gov} 
   \2 operation and control of the ZDC power supplies
   \2 commands: \texttt{bbchv}, \texttt{zdc}, \texttt{richscal}
 \1 \texttt{staruser@startrg.starp.bnl.gov}
   \2 TDC timing of ZDC
 \1 \texttt{sysuser@alh.starp.bnl.gov} 
   \2 old alarm handler for slow controls at STAR
 \1 \texttt{sysuser@alh2.starp.bnl.gov}
   \2 new alarm handler for slow controls at STAR
 \1 \texttt{tof@tofrnps}
   \2 TOF remote network power switch
   \2 accessible only from STAR Gateway
   \2 login password can be found in the "password sheet" for shift leaders
   \2 operation of the power switch for TCIM (especially useful when rebooting the TCIM)
 \1 \url{172.16.15.101/AnalogandCoincidenceLogic13.html}
   \2 accessible from \texttt{startrg.starp.bnl.gov}
   \2 Webpage with the TCIM coincidence logic (it is bookmarked e.g.\ in Firefox on \texttt{startrg.starp.bnl.gov}).
 \1 \texttt{telnet scserv 9010}: 
   \2 accessible  from \texttt{sc5.starp.bnl.gov}
   \2 Can be used for communication with the LeCroy 1440 crate (ZDC HV power supply)
   \2 BDB computer
   \2 to restart the ZDC IOC on BDB, see section \ref{bdbreboot}.
\end{outline}


\section{Power suplies control}
Power supplies can be accessed and controlled using graphical windows, that can be opened at SC5 computer. 
Window for BBC HV (Fig.~\ref{bbchv}) is opened with command \texttt{bbchv}. From this windows, other control windows can be accessed, showing actual performance of ZDC, SMD and VPD HV. AC trips can be controlled and cleared as well. Green dots on the right panel shows if the HV supply is fully on or off. Trips can be cleared only if HV is on. ZDC, upVPD and SMD can be turned on and off from here, with the buttons on the left side.

Not all of the control buttons on the BBC HV window trigger opening of another graphical window or any direct response. However, they work as a command, which results in showing of some data in terminal at BDB computer.

\subsection{Notes}
Scalable fonts are needed to be installed on your computer, in order to open graphical applications at remote hosts.
These are in package \texttt{xfonts-100dpi}, to install, just type in terminal: \texttt{sudo apt-get install xfonts-100dpi}
 
\begin{figure}[htb]
  \begin{center}
    \includegraphics[width=1.\textwidth]{img/bbchv.png}
  \end{center}
  \caption{Graphical window for control of high voltage power supplies, opened after entering \texttt{bbchv} command at SC5 computer.}
\label{bbchv}
\end{figure}

More detailed ZDC HV control window (Fig.~\ref{zdcwindow}) can be opened either by clicking on the button with window icon, next to the title "ZDC" in the left panel of BBC HV control window, or by typing \texttt{zdc} command in terminal at SC5 computer. Set values of HV on all of the PMTs and their readback values are shown in this window.  ZDC can be turned on and off also from here.

\begin{figure}[htb]
  \begin{center}
    \includegraphics[width=.6\textwidth]{img/zdc.png}
  \end{center}
  \caption{Graphical window for control of high voltage power supplies, opened after entering \texttt{zdc} command at SC5 computer.}
\label{zdcwindow}
\end{figure}

Values of RICH Scaler Rates for BBC and ZDC detectors can be displayed with \texttt{richscal} command at SC5 computer. "ZDC-nokill" is the event rate without "ZDC-kill" signal. As it was already mentioned, "ZDC And" is the rate of ZDC east and ZDC west coincidence.

\begin{figure}[htb]
  \begin{center}
    \includegraphics[width=.6\textwidth]{img/richscal.png}
  \end{center}
  \caption{Graphical window for control of high voltage power supplies, opened after entering \texttt{richscal} command at SC5 computer.}
\label{richscal}
\end{figure}

% \newpage
\subsection{Instructions for BDB reboot}
\label{bdbreboot}

\begin{enumerate}
\item Connect or go to \texttt{sc5.starp.bnl.gov} computer.
\item In a termnial, type \texttt{telnet scserv 9010}, and hit \texttt{[Enter]}.
\item Hit  \texttt{[Enter]} again.
\item If upVPD is on, turn it off.
\item Press \texttt{Ctrl + X} to reboot the processor.
\item Wait until the processors reboot information comes to the following lines:
\noindent
\begin{verbatim}
 Done executing startup script
 /home/sysuser/epics3.13.10/Application/iocBoot/iocbbc/stold.cmd
 bdb> checking system
\end{verbatim}

\begin{itemize}
 \item Please note that sometimes you might need to scroll up in case you missed this line appearing in the display.
 \item During the process the following GUIs will go white: upVPD, BBC LeCroy and ZDC. Ignore any messages you see on the Linux screens afterwards. If a GUI remains blank but the reset is complete, try to maximize and restore the GUI to their original size.
\end{itemize}

\item When the terminal is done updating and all GUIs are back, \textbf{turn on what needs to be on}: BBC HV, ZDC HV, EAST/WEST SMD and PP2PP HV. \textbf{Check the required detector state for the current conditions.}
\item Press \texttt{Ctrl + ]}. This should bring the prompt to \texttt{telnet>}.
\item Type \texttt{quit} and hit \texttt{[Enter]}.
\item Make an entry in the shift log when done.
\end{enumerate}

These instructions are (and should be) also placed in the STAR control room.

 

\section{Tests of the hardware before the start of the collisions at RHIC}
The PMTs' response to cosmics needs to be checked before the run. After you turn the ZDC HV on, you can check the signal with an oscilloscope on the signal output at the patch panels close to the TCIM (See Fig.\ \ref{tcimpp}). A good way of doing this is to turn on the the HV on the towers one-by-one so you can see if the output of some ZDC towers is swapped.
Moreover, the ZDC cables may be swapped with the SMD, disconnected, or faulty. Therefore, if the signal is missing on the patch panel, you should follow the cables to the PMTs and check if all the cables are in the right place. Equally, you should check the HV connection.

\begin{figure}[htb]
\begin{center}
\includegraphics[width=.7\textwidth]{img/zdcepatch.jpg}
\end{center}
\caption{Outputs from PMTs at patch panel for ZDC east, that needs to be checked.}
\label{zdcepatch}
\end{figure}

ZDC west and east sum signals are typically checked on outputs of both TCIM and logic unit. ``ZDC and'' and ``ZDC kill'' signals are controlled on TCIM using  signal from a pulser. The pulser needs to be connected to one of the channels of ZDC East and West simultaneously. Typically, you divide the signal from the pulser and connect it to the ZDC East1 and West1 towers input of the TCIM. Now, you should monitor the RICH scalers output GUI on the \texttt{sc5} computer and the TCIM coincidence logic webpage at \url{172.16.15.101/AnalogandCoincidenceLogic13.html}.
